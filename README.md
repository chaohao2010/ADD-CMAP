# ADD_CMAP.py
## Add CMAP parameters into original AMBER prmtop file

&ensp;&ensp;In order to obtain a accurate descripion of intrinscally disorder proteins(IDPs) ensembles, grid-based energy correction maps (CMAP) method
<sup>[1]</sup> was applied in MD simulation to improve the sampling of backbond dihedrals of IDPs which have high heterogeneous conformers.
Therefore, several IDP-sepcific force fields were developed based on the classical AMBER force fields by adding CMAP energy terms in MD
simulations, such as ff99IDPs<sup>[2][3]</sup>, ff14IDPs<sup>[4]</sup>, ff14IDPSFF<sup>[5]</sup>, ff03CMAP<sup>[6]</sup>, ESFF1<sup>[7]</sup>.  

&ensp;&ensp;This script is used to add CMAP parameters into the prmtop file which is generated by *tleap* module of AMBER packages. This script provides interacting command lines to add CMAP parameters to the residues of interest and the silent mode to skip these interacting command lines and add CMAP parameters to all residues.    

Usage: python3 ADD-CMAP.py -p amber.prmtop -c CMAP_parameters -o amber_CMAP.prmtop [-se]  

    -p    prmtop files generated by tleap with  
            leaprc.ff99SBildn (if you want ot use ff99IDPs force field)
            leaprc.ff14SB (if you want ot use ff14IDPs, ff14IDPSFF or ESFF1 force field)
            leaprc.ff03.r1 (if you want to use ff03CMAP force field)
    -c    CMAP parameter file
    -o    prmtop files within CMAP parameters
    -e    option for environment-specific force field
    -s    silent mode

Examples:  
For **residue-specific** force fields, such as *ff99IDPs, ff14IDPs, ff14IDPSFF, ff03CMAP*  
&ensp;&ensp;use '-s' option to add CMAP parameters to **ALL** available residues  

    python3 ADD-CMAP.py -p amber.prmtop -c ff03CMAP.para -o amber_CMAP.prmtop -s
    
&ensp;&ensp;remove '-s' option to interactively add CMAP parameters to residues of your interest, such as residues in disordered region.  
     
    python3 ADD-CMAP.py -p amber.prmtop -c ff03CMAP.para -o amber_CMAP.prmtop
    
For **environment-specific** force field *ESFF1*  
&ensp;&ensp;use '-e' option to add the environment-specific CMAP parameters  
     
    python3 ADD-CMAP.py -p amber.prmtop -c ESFF1.para -o amber_CMAP.prmtop -e -s

**Note: The new prmtop file with CMAP paramters are not supported in *cpptraj* of AMBER 16 or 18, so the original prmtop file are needed when you use *cpptraj* to analyse the MD trajectories.**

Please cite the following papers if you are using this script:  

<sup>[1]</sup> MacKerell A. D., et al. Improved treatment of the protein backbone in empirical force fields. *J. Am. Chem. Soc*. **2004**, 126, 698-699. (CMAP Method)  
<sup>[2]</sup> Wang W., et al. New force field on modeling intrinsically disordered proteins. *Chem. Biol. Drug Des*. **2014**, 84, 253-269. (ff99IDPs force field)  
<sup>[3]</sup> Ye W., et al. Test and Evaluation of ff99IDPs Force Field for Intrinsically Disordered Proteins. *J. Chem. Inf. Model*. **2015**, 55, 1021-1029. (ff99IDPs force field)  
<sup>[4]</sup> Song D., et al. ff14IDPs force field improving the conformation sampling of intrinsically disordered proteins. *Chem. Biol. Drug Des*. **2017**, 89, 5-15. (ff14IDPs force field)  
<sup>[5]</sup> Song D., et al. The IDP-Specific Force Field ff14IDPSFF Improves the Conformer Sampling of Intrinsically Disordered Proteins. *J. Chem. Inf. Model*. **2017**, 57, 1166-1178. (ff14IDPSFF force field)  
<sup>[6]</sup> Zhang Y. et al. Well-Balanced Force Field ff03CMAP for Folded and Disordered Proteins. *J. Chem. Theory Comput*. **2019**, 15, 12, 6769-6780. (ff03CMAP force field)  
<sup>[7]</sup> Song D. et al. Environment-Specific Force Field for Intrinsically Disordered and Ordered Proteins. *J. Chem. Inf. Model*. **2020**, 60, 4, 2257â€“2267(ESFF1 force field)
